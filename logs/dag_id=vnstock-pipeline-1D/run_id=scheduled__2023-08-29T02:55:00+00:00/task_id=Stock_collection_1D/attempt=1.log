[2023-08-30T02:55:20.111+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: vnstock-pipeline-1D.Stock_collection_1D scheduled__2023-08-29T02:55:00+00:00 [queued]>
[2023-08-30T02:55:20.115+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: vnstock-pipeline-1D.Stock_collection_1D scheduled__2023-08-29T02:55:00+00:00 [queued]>
[2023-08-30T02:55:20.116+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 4
[2023-08-30T02:55:20.127+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): Stock_collection_1D> on 2023-08-29 02:55:00+00:00
[2023-08-30T02:55:20.131+0000] {standard_task_runner.py:57} INFO - Started process 235488 to run task
[2023-08-30T02:55:20.132+0000] {clientserver.py:543} INFO - Closing down clientserver connection
[2023-08-30T02:55:20.139+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'vnstock-pipeline-1D', 'Stock_collection_1D', 'scheduled__2023-08-29T02:55:00+00:00', '--job-id', '213', '--raw', '--subdir', 'DAGS_FOLDER/main.py', '--cfg-path', '/tmp/tmpau0g2s2j']
[2023-08-30T02:55:20.139+0000] {standard_task_runner.py:85} INFO - Job 213: Subtask Stock_collection_1D
[2023-08-30T02:55:20.179+0000] {task_command.py:415} INFO - Running <TaskInstance: vnstock-pipeline-1D.Stock_collection_1D scheduled__2023-08-29T02:55:00+00:00 [running]> on host vnstock-pipeline-vm.us-central1-c.c.vnstock-pipeline.internal
[2023-08-30T02:55:20.228+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='nguyentuanduong555@gmail.com' AIRFLOW_CTX_DAG_OWNER='Duong_' AIRFLOW_CTX_DAG_ID='vnstock-pipeline-1D' AIRFLOW_CTX_TASK_ID='Stock_collection_1D' AIRFLOW_CTX_EXECUTION_DATE='2023-08-29T02:55:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-08-29T02:55:00+00:00'
[2023-08-30T02:55:22.242+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:22.243+0000] {logging_mixin.py:151} INFO - 1606/1607_SSI
[2023-08-30T02:55:24.031+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:24.032+0000] {logging_mixin.py:151} INFO - 1605/1607_BCM
[2023-08-30T02:55:25.794+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:25.794+0000] {logging_mixin.py:151} INFO - 1604/1607_VHM
[2023-08-30T02:55:27.597+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:27.597+0000] {logging_mixin.py:151} INFO - 1603/1607_VIC
[2023-08-30T02:55:29.412+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:29.413+0000] {logging_mixin.py:151} INFO - 1602/1607_VRE
[2023-08-30T02:55:31.186+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:31.187+0000] {logging_mixin.py:151} INFO - 1601/1607_BVH
[2023-08-30T02:55:33.000+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:33.001+0000] {logging_mixin.py:151} INFO - 1600/1607_POW
[2023-08-30T02:55:34.760+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:34.761+0000] {logging_mixin.py:151} INFO - 1599/1607_GAS
[2023-08-30T02:55:36.504+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:36.505+0000] {logging_mixin.py:151} INFO - 1598/1607_ACB
[2023-08-30T02:55:38.303+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:38.304+0000] {logging_mixin.py:151} INFO - 1597/1607_BID
[2023-08-30T02:55:40.044+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:40.045+0000] {logging_mixin.py:151} INFO - 1596/1607_CTG
[2023-08-30T02:55:41.751+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:41.751+0000] {logging_mixin.py:151} INFO - 1595/1607_HDB
[2023-08-30T02:55:43.510+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:43.510+0000] {logging_mixin.py:151} INFO - 1594/1607_MBB
[2023-08-30T02:55:45.336+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:45.337+0000] {logging_mixin.py:151} INFO - 1593/1607_SSB
[2023-08-30T02:55:47.215+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:47.216+0000] {logging_mixin.py:151} INFO - 1592/1607_SHB
[2023-08-30T02:55:48.969+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:48.970+0000] {logging_mixin.py:151} INFO - 1591/1607_STB
[2023-08-30T02:55:50.736+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:50.736+0000] {logging_mixin.py:151} INFO - 1590/1607_TCB
[2023-08-30T02:55:52.554+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:52.555+0000] {logging_mixin.py:151} INFO - 1589/1607_TPB
[2023-08-30T02:55:54.293+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:54.293+0000] {logging_mixin.py:151} INFO - 1588/1607_VCB
[2023-08-30T02:55:56.028+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:56.028+0000] {logging_mixin.py:151} INFO - 1587/1607_VIB
[2023-08-30T02:55:57.776+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:57.776+0000] {logging_mixin.py:151} INFO - 1586/1607_VPB
[2023-08-30T02:55:59.539+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:55:59.540+0000] {logging_mixin.py:151} INFO - 1585/1607_HPG
[2023-08-30T02:56:00.437+0000] {logging_mixin.py:151} INFO - 1584_error_1607_GVR
[2023-08-30T02:56:00.437+0000] {collect_gcs.py:78} ERROR - message
Traceback (most recent call last):
  File "/home/nguyentuanduong7/airflow/src/pluggin/collect_gcs.py", line 66, in stock_collection_1D
    stock_data=stock_historical_data (symbol=stock, start_date=current_date, end_date=current_date, resolution=resolution, type='stock')
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/vnstock/stock.py", line 148, in stock_historical_data
    df = stock_ohlc(symbol, start_date, end_date, resolution, type, headers)
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/vnstock/stock.py", line 179, in stock_ohlc
    df = pd.DataFrame(response)
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 709, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 481, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 115, in arrays_to_mgr
    index = _extract_index(arrays)
  File "/home/nguyentuanduong7/.local/lib/python3.8/site-packages/pandas/core/internals/construction.py", line 645, in _extract_index
    raise ValueError("If using all scalar values, you must pass an index")
ValueError: If using all scalar values, you must pass an index
[2023-08-30T02:56:02.263+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:02.263+0000] {logging_mixin.py:151} INFO - 1583/1607_MSN
[2023-08-30T02:56:04.046+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:04.046+0000] {logging_mixin.py:151} INFO - 1582/1607_VNM
[2023-08-30T02:56:05.882+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:05.883+0000] {logging_mixin.py:151} INFO - 1581/1607_SAB
[2023-08-30T02:56:07.670+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:07.670+0000] {logging_mixin.py:151} INFO - 1580/1607_VJC
[2023-08-30T02:56:09.422+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:09.422+0000] {logging_mixin.py:151} INFO - 1579/1607_MWG
[2023-08-30T02:56:11.202+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:11.202+0000] {logging_mixin.py:151} INFO - 1578/1607_PLX
[2023-08-30T02:56:12.955+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:12.956+0000] {logging_mixin.py:151} INFO - 1577/1607_FPT
[2023-08-30T02:56:14.714+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:14.714+0000] {logging_mixin.py:151} INFO - 1576/1607_MFS
[2023-08-30T02:56:16.324+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:16.325+0000] {logging_mixin.py:151} INFO - 1575/1607_ABC
[2023-08-30T02:56:18.135+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:18.135+0000] {logging_mixin.py:151} INFO - 1574/1607_VGI
[2023-08-30T02:56:19.937+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:19.937+0000] {logging_mixin.py:151} INFO - 1573/1607_FOX
[2023-08-30T02:56:21.715+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:21.716+0000] {logging_mixin.py:151} INFO - 1572/1607_PAI
[2023-08-30T02:56:23.513+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:23.514+0000] {logging_mixin.py:151} INFO - 1571/1607_PIA
[2023-08-30T02:56:25.283+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:25.283+0000] {logging_mixin.py:151} INFO - 1570/1607_PTP
[2023-08-30T02:56:27.057+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:27.057+0000] {logging_mixin.py:151} INFO - 1569/1607_TTN
[2023-08-30T02:56:28.786+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:28.786+0000] {logging_mixin.py:151} INFO - 1568/1607_FUCTVGF3
[2023-08-30T02:56:30.690+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:30.690+0000] {logging_mixin.py:151} INFO - 1567/1607_FUEIP100
[2023-08-30T02:56:32.419+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:32.420+0000] {logging_mixin.py:151} INFO - 1566/1607_FUEKIV30
[2023-08-30T02:56:34.187+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:34.188+0000] {logging_mixin.py:151} INFO - 1565/1607_FUCTVGF4
[2023-08-30T02:56:35.928+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:35.928+0000] {logging_mixin.py:151} INFO - 1564/1607_FUEDCMID
[2023-08-30T02:56:37.658+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:37.658+0000] {logging_mixin.py:151} INFO - 1563/1607_FUEKIVFS
[2023-08-30T02:56:39.465+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:39.466+0000] {logging_mixin.py:151} INFO - 1562/1607_FUEMAVND
[2023-08-30T02:56:41.287+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:41.288+0000] {logging_mixin.py:151} INFO - 1561/1607_FUEFCV50
[2023-08-30T02:56:42.991+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:42.992+0000] {logging_mixin.py:151} INFO - 1560/1607_FUEBFVND
[2023-08-30T02:56:44.783+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:44.783+0000] {logging_mixin.py:151} INFO - 1559/1607_FUESSV50
[2023-08-30T02:56:46.591+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:46.592+0000] {logging_mixin.py:151} INFO - 1558/1607_E1VFVN30
[2023-08-30T02:56:48.401+0000] {logging_mixin.py:151} INFO - Empty DataFrame
Columns: [time, open, high, low, close, volume, ticker, type]
Index: []
[2023-08-30T02:56:48.401+0000] {logging_mixin.py:151} INFO - 1557/1607_FUESSVFL
[2023-08-30T02:56:48.402+0000] {python.py:194} INFO - Done. Returned value was: Done
[2023-08-30T02:56:48.416+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=vnstock-pipeline-1D, task_id=Stock_collection_1D, execution_date=20230829T025500, start_date=20230830T025520, end_date=20230830T025648
[2023-08-30T02:56:48.443+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2023-08-30T02:56:48.456+0000] {taskinstance.py:2784} INFO - 1 downstream tasks scheduled from follow-on schedule check
